<!DOCTYPE html>
<meta charset="utf-8">
<title>pupilplayer demo</title>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
<script src="/dist/build.js"></script>

<div id="app">
  <form @submit.prevent="open_file">
    <input type="file" ref="file" required accept="video/*">
    <button type="submit">Open</button>
  </form>
  <pupilplayer :src="src" :danmakus="danmakus" @add-danmaku="add_danmaku"/>
</div>

<script>
  var app = new Vue({
    el: '#app',
    data: {
      src: '',
      danmakus: [],
      danmaku_timelist: []
    },
    methods: {
      open_file(){
        this.src = URL.createObjectURL(this.$refs.file.files[0])
      },
      add_danmaku(dmk){
        var pos = _.sortedLastIndex(this.danmaku_timelist, dmk.time)
        this.danmakus.splice(pos, 0, dmk)
        this.danmaku_timelist.splice(pos, 0, dmk.time)
      }
    }
  })
</script>
